{"remainingRequest":"E:\\gitData\\wangfuj\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\gitData\\wangfuj\\jeecg-boot\\ant-design-vue-jeecg\\src\\views\\modules\\online\\cgform\\OnlCgformCopyList.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\gitData\\wangfuj\\jeecg-boot\\ant-design-vue-jeecg\\src\\views\\modules\\online\\cgform\\OnlCgformCopyList.vue","mtime":1618453704977},{"path":"E:\\gitData\\wangfuj\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\babel-loader\\lib\\index.js","mtime":1618457261991},{"path":"E:\\gitData\\wangfuj\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1605147250913},{"path":"E:\\gitData\\wangfuj\\jeecg-boot\\ant-design-vue-jeecg\\node_modules\\vue-loader\\lib\\index.js","mtime":1618457253212}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { deleteAction, postAction,getAction } from '@/api/manage'\nimport { JeecgListMixin } from '@/mixins/JeecgListMixin'\nimport Clipboard from 'clipboard'\nimport { filterObj } from '@/utils/util';\n\nexport default {\n  name: 'OnlCgformHeadList',\n  mixins: [JeecgListMixin],\n  components: {\n  },\n  data() {\n    return {\n      description: 'Online表单视图',\n      // 表头\n      columns: [\n        {\n          title: '#',\n          dataIndex: '',\n          key: 'rowIndex',\n          width: 60,\n          align: 'center',\n          customRender: function(t, r, index) {\n            return parseInt(index) + 1\n          }\n        },\n\n        {\n          title: '视图表名',\n          align: 'center',\n          dataIndex: 'tableName'\n        },\n        {\n          title: '视图表描述',\n          align: 'center',\n          dataIndex: 'tableTxt'\n        },\n        {\n          title: '原表版本',\n          align: 'center',\n          dataIndex: 'tableVersion'\n        },\n        {\n          title: '视图版本',\n          align: 'center',\n          dataIndex: 'copyVersion'\n        },\n        {\n          title: '操作',\n          dataIndex: 'action',\n          align: 'center',\n          scopedSlots: { customRender: 'action' }\n        }\n      ],\n      url: {\n        list: '/online/cgform/head/list',\n        delete: '/online/cgform/head/delete',\n        deleteBatch: '/online/cgform/head/deleteBatch',\n        removeRecord: '/online/cgform/head/removeRecord',\n      },\n      tableTypeDictOptions: [],\n      sexDictOptions: [],\n      syncModalVisible: false,\n      syncFormId: '',\n      synMethod: 'normal',\n      syncLoading: false,\n      onlineUrlTitle: '',\n      onlineUrlVisible: false,\n      onlineUrl: '',\n      selectedRowKeys: [],\n      selectedRows: [],\n      physicId:\"\"\n    }\n  },\n  watch: {\n    '$route'() {\n      this.loadData()\n    }\n  },\n  methods: {\n    getQueryParams() {\n      //获取查询条件\n      var param = Object.assign({}, this.queryParam, this.isorter ,this.filters);\n      param.field = this.getQueryField();\n      param.pageNo = this.ipagination.current;\n      param.pageSize = this.ipagination.pageSize;\n      param.copyType = 1;\n      param.physicId = this.physicId;\n      return filterObj(param);\n    },\n\n    loadData(arg) {\n      if(!this.$route.params.code){\n        return false\n      }\n      this.physicId = this.$route.params.code\n      if(!this.url.list){\n        this.$message.error(\"请设置url.list属性!\")\n        return\n      }\n      //加载数据 若传入参数1则加载第一页的内容\n      if (arg === 1) {\n        this.ipagination.current = 1;\n      }\n      var params = this.getQueryParams();//查询条件\n      this.loading = true;\n      getAction(this.url.list, params).then((res) => {\n        if (res.success) {\n          this.dataSource = res.result.records;\n          this.ipagination.total = res.result.total;\n        }\n        if(res.code===510){\n          this.$message.warning(res.message)\n        }\n        this.loading = false;\n      })\n    },\n\n    goPageOnline(rd) {\n      if(rd.isTree=='Y'){\n        this.$router.push({ path: '/online/cgformTreeList/' + rd.id })\n      }else{\n        this.$router.push({ path: '/online/cgformList/' + rd.id })\n      }\n    },\n    handleOnlineUrlClose() {\n      this.onlineUrlTitle = ''\n      this.onlineUrlVisible = false\n    },\n    handleOnlineUrlShow(record) {\n      if(record.isTree=='Y'){\n        this.onlineUrl = `/online/cgformTreeList/${record.id}`\n      }else{\n        this.onlineUrl = `/online/cgformList/${record.id}`\n      }\n      this.onlineUrlVisible = true\n      this.onlineUrlTitle = '菜单链接[' + record.tableTxt + ']'\n    },\n    handleRemoveRecord(id) {\n      let that = this\n      this.$confirm({\n        title: '确认要移除此记录?',\n        onOk() {\n          deleteAction(that.url.removeRecord, { id: id }).then((res) => {\n            if (res.success) {\n              that.$message.success('移除成功')\n              that.loadData()\n            } else {\n              that.$message.warning(res.message)\n            }\n          })\n        },\n        onCancel() {\n        }\n      })\n    },\n    doEnhanceJs() {\n      if (!this.selectedRowKeys || this.selectedRowKeys.length != 1) {\n        this.$message.warning('请先选中一条记录')\n        return\n      }\n      this.$refs.ehjs.show(this.selectedRowKeys[0])\n    },\n    doEnhanceSql() {\n      if (!this.selectedRowKeys || this.selectedRowKeys.length != 1) {\n        this.$message.warning('请先选中一条记录')\n        return\n      }\n      this.$refs.ehsql.show(this.selectedRowKeys[0])\n    },\n    doEnhanceJava() {\n      if (!this.selectedRowKeys || this.selectedRowKeys.length != 1) {\n        this.$message.warning('请先选中一条记录')\n        return\n      }\n      this.$refs.ehjava.show(this.selectedRowKeys[0])\n    },\n    doCgformButton() {\n      if (!this.selectedRowKeys || this.selectedRowKeys.length != 1) {\n        this.$message.warning('请先选中一条记录')\n        return\n      }\n      this.$refs.btnList.show(this.selectedRowKeys[0])\n\n      //this.$router.push({ path: '/online/cgformButton/' + this.selectedRowKeys[0] })\n    },\n    importOnlineForm() {\n      this.$refs.transd2o.show()\n    },\n    transOk() {\n      this.loadData()\n    },\n    onSelectChange(keys, rows) {\n      this.selectedRowKeys = keys\n      this.selectedRows = rows\n    },\n    onCopyUrl(){\n      var clipboard = new Clipboard('.copy-this-text')\n      clipboard.on('success', () => {\n        clipboard.destroy()\n        this.$message.success('复制成功')\n        this.handleOnlineUrlClose()\n      })\n      clipboard.on('error', () => {\n        this.$message.error('该浏览器不支持自动复制')\n        clipboard.destroy()\n      })\n    },\n    showMyCopyInfo(id){\n      console.log(\"查看复制表单的信息\",id)\n    },\n    copyConfig(id){\n      postAction(`${this.url.copyOnline}?code=${id}`).then(res=>{\n        if(res.success){\n          this.$message.success(\"复制成功\")\n          this.loadData()\n        }else{\n          this.$message.error(\"复制失败>>\"+res.message)\n        }\n      })\n    }\n\n  }\n}\n",null]}